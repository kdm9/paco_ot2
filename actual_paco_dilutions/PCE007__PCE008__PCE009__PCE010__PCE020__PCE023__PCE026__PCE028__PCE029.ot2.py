from opentrons import protocol_api

config = {
	"PLATES": {"PCE007": {"A1": 0, "B1": 0, "C1": 0, "D1": 0, "E1": 0, "F1": 0, "G1": 0, "H1": 0, "A2": 0, "B2": 0, "C2": 0, "D2": 0, "E2": 27.1, "F2": 0, "G2": 0, "H2": 0, "A3": 0, "B3": 13.8, "C3": 5.7, "D3": 0, "E3": 0, "F3": 0, "G3": 0, "H3": 0, "A4": 0, "B4": 0, "C4": 0, "D4": 0, "E4": 6.2, "F4": 0, "G4": 0, "H4": 0, "A5": 0, "B5": 0, "C5": 64.5, "D5": 0, "E5": 0, "F5": 0, "G5": 0, "H5": 20.4, "A6": 0, "B6": 0, "C6": 0, "D6": 0, "E6": 0, "F6": 0, "G6": 0, "H6": 0, "A7": 0, "B7": 0, "C7": 0, "D7": 0, "E7": 0, "F7": 0, "G7": 0, "H7": 0, "A8": 0, "B8": 10.0, "C8": 0, "D8": 8.7, "E8": 9.9, "F8": 0, "G8": 24.8, "H8": 17.9, "A9": 0, "B9": 6.0, "C9": 0, "D9": 0, "E9": 10.5, "F9": 0, "G9": 0, "H9": 0, "A10": 20.1, "B10": 0, "C10": 0, "D10": 18.3, "E10": 0, "F10": 6.7, "G10": 6.9, "H10": 0, "A11": 0, "B11": 0, "C11": 0, "D11": 6.1, "E11": 0, "F11": 0, "G11": 14.5, "H11": 0, "A12": 0, "B12": 0, "C12": 0, "D12": 0, "E12": 0, "F12": 0, "G12": 0, "H12": 11.8}, "PCE008": {"A1": 0, "B1": 0, "C1": 0, "D1": 0, "E1": 0, "F1": 0, "G1": 0, "H1": 0, "A2": 0, "B2": 0, "C2": 0, "D2": 5.4, "E2": 0, "F2": 0, "G2": 12.4, "H2": 0, "A3": 0, "B3": 0, "C3": 6.1, "D3": 8.9, "E3": 0, "F3": 0, "G3": 0, "H3": 5.6, "A4": 0, "B4": 0, "C4": 0, "D4": 0, "E4": 0, "F4": 0, "G4": 0, "H4": 0, "A5": 26.8, "B5": 7.5, "C5": 0, "D5": 26.1, "E5": 0, "F5": 0, "G5": 0, "H5": 0, "A6": 0, "B6": 0, "C6": 0, "D6": 0, "E6": 0, "F6": 0, "G6": 0, "H6": 0, "A7": 12.0, "B7": 0, "C7": 0, "D7": 0, "E7": 0, "F7": 0, "G7": 0, "H7": 0, "A8": 0, "B8": 10.3, "C8": 0, "D8": 0, "E8": 0, "F8": 0, "G8": 0, "H8": 0, "A9": 0, "B9": 0, "C9": 0, "D9": 9.6, "E9": 0, "F9": 0, "G9": 0, "H9": 0, "A10": 0, "B10": 0, "C10": 0, "D10": 0, "E10": 0, "F10": 0, "G10": 0, "H10": 28.7, "A11": 0, "B11": 0, "C11": 0, "D11": 0, "E11": 0, "F11": 16.4, "G11": 0, "H11": 0, "A12": 0, "B12": 0, "C12": 0, "D12": 0, "E12": 0, "F12": 0, "G12": 0, "H12": 0}, "PCE009": {"A1": 6.6, "B1": 44.6, "C1": 65.3, "D1": 124.2, "E1": 133.9, "F1": 190.0, "G1": 40.9, "H1": 29.6, "A2": 33.4, "B2": 43.7, "C2": 0, "D2": 0, "E2": 11.0, "F2": 18.1, "G2": 36.9, "H2": 115.4, "A3": 12.3, "B3": 42.7, "C3": 13.8, "D3": 28.2, "E3": 9.7, "F3": 25.1, "G3": 20.4, "H3": 42.2, "A4": 66.9, "B4": 40.7, "C4": 58.0, "D4": 78.9, "E4": 12.5, "F4": 0, "G4": 6.9, "H4": 5.1, "A5": 45.7, "B5": 116.6, "C5": 15.7, "D5": 38.5, "E5": 112.3, "F5": 31.2, "G5": 83.3, "H5": 106.2, "A6": 41.6, "B6": 57.5, "C6": 84.8, "D6": 50.7, "E6": 6.2, "F6": 45.4, "G6": 94.8, "H6": 44.5, "A7": 66.1, "B7": 31.8, "C7": 9.7, "D7": 55.9, "E7": 15.7, "F7": 123.7, "G7": 0, "H7": 126.0, "A8": 0, "B8": 23.0, "C8": 36.0, "D8": 49.0, "E8": 30.0, "F8": 66.3, "G8": 22.9, "H8": 0, "A9": 27.2, "B9": 57.1, "C9": 18.4, "D9": 8.7, "E9": 67.6, "F9": 10.5, "G9": 24.7, "H9": 33.9, "A10": 9.2, "B10": 31.0, "C10": 99.5, "D10": 14.3, "E10": 23.3, "F10": 0, "G10": 52.0, "H10": 6.4, "A11": 25.2, "B11": 7.8, "C11": 5.3, "D11": 17.5, "E11": 15.5, "F11": 6.6, "G11": 104.2, "H11": 9.8, "A12": 21.0, "B12": 9.3, "C12": 0, "D12": 53.7, "E12": 49.5, "F12": 18.4, "G12": 32.0, "H12": 42.3}, "PCE010": {"A1": 0, "B1": 0, "C1": 0, "D1": 0, "E1": 0, "F1": 0, "G1": 0, "H1": 0, "A2": 0, "B2": 0, "C2": 0, "D2": 0, "E2": 0, "F2": 0, "G2": 0, "H2": 0, "A3": 21.2, "B3": 0, "C3": 0, "D3": 0, "E3": 0, "F3": 0, "G3": 7.5, "H3": 0, "A4": 0, "B4": 0, "C4": 0, "D4": 0, "E4": 15.3, "F4": 0, "G4": 0, "H4": 0, "A5": 0, "B5": 0, "C5": 0, "D5": 0, "E5": 0, "F5": 6.9, "G5": 0, "H5": 0, "A6": 0, "B6": 0, "C6": 0, "D6": 0, "E6": 0, "F6": 0, "G6": 0, "H6": 0, "A7": 0, "B7": 84.6, "C7": 0, "D7": 0, "E7": 0, "F7": 0, "G7": 0, "H7": 0, "A8": 15.5, "B8": 0, "C8": 0, "D8": 0, "E8": 0, "F8": 0, "G8": 0, "H8": 0, "A9": 0, "B9": 0, "C9": 13.5, "D9": 0, "E9": 0, "F9": 0, "G9": 0, "H9": 0, "A10": 0, "B10": 0, "C10": 0, "D10": 0, "E10": 0, "F10": 0, "G10": 0, "H10": 0, "A11": 0, "B11": 0, "C11": 0, "D11": 0, "E11": 0, "F11": 0, "G11": 0, "H11": 0, "A12": 0, "B12": 0, "C12": 0, "D12": 0, "E12": 0, "F12": 0, "G12": 0, "H12": 5.7}, "PCE020": {"A1": 190.0, "B1": 30.8, "C1": 190.0, "D1": 190.0, "E1": 190.0, "F1": 99.5, "G1": 190.0, "H1": 190.0, "A2": 104.7, "B2": 137.3, "C2": 113.3, "D2": 47.9, "E2": 112.5, "F2": 24.3, "G2": 137.6, "H2": 94.0, "A3": 143.0, "B3": 126.9, "C3": 131.7, "D3": 135.6, "E3": 127.0, "F3": 132.3, "G3": 10.2, "H3": 128.7, "A4": 114.3, "B4": 31.6, "C4": 134.1, "D4": 138.4, "E4": 34.2, "F4": 120.6, "G4": 118.3, "H4": 56.3, "A5": 76.4, "B5": 133.8, "C5": 0, "D5": 117.7, "E5": 110.3, "F5": 38.4, "G5": 83.3, "H5": 102.0, "A6": 145.1, "B6": 22.4, "C6": 0, "D6": 93.9, "E6": 145.2, "F6": 143.7, "G6": 153.1, "H6": 157.3, "A7": 99.2, "B7": 70.9, "C7": 146.9, "D7": 136.1, "E7": 148.6, "F7": 116.2, "G7": 107.5, "H7": 124.1, "A8": 132.5, "B8": 21.0, "C8": 117.3, "D8": 145.1, "E8": 75.8, "F8": 154.1, "G8": 136.7, "H8": 46.3, "A9": 114.5, "B9": 116.0, "C9": 139.9, "D9": 82.7, "E9": 14.9, "F9": 71.8, "G9": 69.0, "H9": 102.1, "A10": 124.2, "B10": 125.9, "C10": 57.6, "D10": 25.6, "E10": 108.3, "F10": 113.7, "G10": 108.7, "H10": 81.4, "A11": 0, "B11": 83.7, "C11": 76.0, "D11": 32.6, "E11": 74.5, "F11": 45.5, "G11": 84.7, "H11": 133.0, "A12": 113.3, "B12": 93.2, "C12": 113.4, "D12": 139.5, "E12": 148.8, "F12": 147.8, "G12": 115.3, "H12": 84.5}, "PCE023": {"A1": 190.0, "B1": 190.0, "C1": 0, "D1": 183.9, "E1": 190.0, "F1": 188.5, "G1": 190.0, "H1": 190.0, "A2": 190.0, "B2": 190.0, "C2": 186.8, "D2": 190.0, "E2": 190.0, "F2": 166.3, "G2": 190.0, "H2": 187.2, "A3": 190.0, "B3": 190.0, "C3": 190.0, "D3": 190.0, "E3": 190.0, "F3": 190.0, "G3": 190.0, "H3": 190.0, "A4": 190.0, "B4": 190.0, "C4": 190.0, "D4": 190.0, "E4": 190.0, "F4": 190.0, "G4": 190.0, "H4": 123.3, "A5": 190.0, "B5": 190.0, "C5": 190.0, "D5": 190.0, "E5": 190.0, "F5": 176.4, "G5": 190.0, "H5": 190.0, "A6": 190.0, "B6": 190.0, "C6": 178.7, "D6": 190.0, "E6": 190.0, "F6": 190.0, "G6": 164.0, "H6": 184.7, "A7": 188.6, "B7": 190.0, "C7": 57.9, "D7": 190.0, "E7": 190.0, "F7": 0, "G7": 190.0, "H7": 190.0, "A8": 188.1, "B8": 177.8, "C8": 109.9, "D8": 185.8, "E8": 190.0, "F8": 189.6, "G8": 177.5, "H8": 190.0, "A9": 183.0, "B9": 190.0, "C9": 190.0, "D9": 190.0, "E9": 190.0, "F9": 189.7, "G9": 190.0, "H9": 190.0, "A10": 176.4, "B10": 173.0, "C10": 190.0, "D10": 172.0, "E10": 190.0, "F10": 190.0, "G10": 185.3, "H10": 140.7, "A11": 152.4, "B11": 187.1, "C11": 190.0, "D11": 190.0, "E11": 190.0, "F11": 77.8, "G11": 171.1, "H11": 160.8, "A12": 152.6, "B12": 170.7, "C12": 188.2, "D12": 190.0, "E12": 190.0, "F12": 183.5, "G12": 0, "H12": 164.2}, "PCE026": {"A1": 0, "B1": 170.2, "C1": 166.9, "D1": 155.2, "E1": 179.8, "F1": 190.0, "G1": 152.7, "H1": 154.5, "A2": 190.0, "B2": 190.0, "C2": 186.6, "D2": 190.0, "E2": 190.0, "F2": 190.0, "G2": 190.0, "H2": 190.0, "A3": 190.0, "B3": 190.0, "C3": 190.0, "D3": 190.0, "E3": 190.0, "F3": 190.0, "G3": 190.0, "H3": 169.4, "A4": 157.1, "B4": 156.1, "C4": 160.1, "D4": 157.6, "E4": 147.2, "F4": 150.8, "G4": 153.6, "H4": 151.4, "A5": 87.2, "B5": 151.9, "C5": 158.3, "D5": 144.2, "E5": 145.0, "F5": 167.6, "G5": 143.7, "H5": 141.2, "A6": 145.9, "B6": 140.2, "C6": 52.9, "D6": 137.7, "E6": 132.0, "F6": 141.8, "G6": 156.2, "H6": 134.6, "A7": 135.9, "B7": 0, "C7": 124.8, "D7": 81.2, "E7": 31.8, "F7": 16.8, "G7": 121.0, "H7": 109.7, "A8": 137.3, "B8": 104.1, "C8": 155.4, "D8": 150.7, "E8": 138.0, "F8": 77.4, "G8": 150.2, "H8": 153.5, "A9": 152.0, "B9": 151.7, "C9": 59.5, "D9": 130.1, "E9": 142.0, "F9": 158.6, "G9": 123.7, "H9": 144.0, "A10": 142.2, "B10": 154.1, "C10": 156.3, "D10": 156.8, "E10": 150.9, "F10": 151.8, "G10": 154.4, "H10": 156.9, "A11": 157.5, "B11": 153.0, "C11": 153.9, "D11": 153.2, "E11": 135.4, "F11": 163.5, "G11": 158.6, "H11": 151.8, "A12": 136.7, "B12": 134.9, "C12": 136.5, "D12": 139.0, "E12": 137.6, "F12": 0, "G12": 18.6, "H12": 17.1}, "PCE028": {"A1": 0, "B1": 0, "C1": 0, "D1": 0, "E1": 0, "F1": 0, "G1": 0, "H1": 0, "A2": 0, "B2": 0, "C2": 0, "D2": 0, "E2": 0, "F2": 0, "G2": 0, "H2": 0, "A3": 0, "B3": 0, "C3": 0, "D3": 0, "E3": 0, "F3": 0, "G3": 0, "H3": 0, "A4": 0, "B4": 0, "C4": 0, "D4": 0, "E4": 0, "F4": 0, "G4": 0, "H4": 0, "A5": 0, "B5": 0, "C5": 0, "D5": 0, "E5": 0, "F5": 0, "G5": 0, "H5": 0, "A6": 0, "B6": 0, "C6": 0, "D6": 0, "E6": 0, "F6": 0, "G6": 0, "H6": 0, "A7": 0, "B7": 0, "C7": 0, "D7": 0, "E7": 0, "F7": 0, "G7": 5.5, "H7": 0, "A8": 0, "B8": 0, "C8": 0, "D8": 0, "E8": 0, "F8": 0, "G8": 0, "H8": 0, "A9": 0, "B9": 0, "C9": 0, "D9": 0, "E9": 0, "F9": 0, "G9": 0, "H9": 0, "A10": 0, "B10": 0, "C10": 0, "D10": 0, "E10": 0, "F10": 0, "G10": 0, "H10": 0, "A11": 0, "B11": 0, "C11": 0, "D11": 0, "E11": 0, "F11": 0, "G11": 0, "H11": 0, "A12": 0, "B12": 0, "C12": 0, "D12": 0, "E12": 0, "F12": 0, "G12": 0, "H12": 0}, "PCE029": {"A1": 0, "B1": 0, "C1": 0, "D1": 0, "E1": 0, "F1": 0, "G1": 0, "H1": 0, "A2": 0, "B2": 0, "C2": 0, "D2": 0, "E2": 0, "F2": 0, "G2": 0, "H2": 0, "A3": 0, "B3": 0, "C3": 0, "D3": 0, "E3": 0, "F3": 0, "G3": 0, "H3": 0, "A4": 0, "B4": 0, "C4": 0, "D4": 0, "E4": 0, "F4": 0, "G4": 0, "H4": 0, "A5": 0, "B5": 0, "C5": 0, "D5": 0, "E5": 0, "F5": 0, "G5": 0, "H5": 0, "A6": 0, "B6": 0, "C6": 0, "D6": 0, "E6": 0, "F6": 0, "G6": 0, "H6": 0, "A7": 0, "B7": 0, "C7": 0, "D7": 0, "E7": 0, "F7": 0, "G7": 0, "H7": 0, "A8": 0, "B8": 0, "C8": 0, "D8": 0, "E8": 0, "F8": 0, "G8": 0, "H8": 0, "A9": 0, "B9": 0, "C9": 0, "D9": 0, "E9": 0, "F9": 0, "G9": 0, "H9": 0, "A10": 0, "B10": 0, "C10": 0, "D10": 0, "E10": 0, "F10": 0, "G10": 0, "H10": 0, "A11": 0, "B11": 0, "C11": 0, "D11": 0, "E11": 0, "F11": 0, "G11": 0, "H11": 0, "A12": 0, "B12": 0, "C12": 0, "D12": 0, "E12": 0, "F12": 0, "G12": 0, "H12": 0}},
	"WELL_MAX_VOLUME": 190.0,
}

metadata = {
        'protocolName': "PCE007__PCE008__PCE009__PCE010__PCE020__PCE023__PCE026__PCE028__PCE029",
        'author': 'Kevin Murray',
        'apiLevel': '2.9',
}

def dispense_water_to(plate, water, well_vols, pipette):
    pipette.pick_up_tip()
    for well, volume in well_vols.items():
        if volume < pipette.min_volume:
            continue
        if volume > config["WELL_MAX_VOLUME"]:
            raise ValueError(f"ERROR! overfull well {well} on plate {plate}")
        transferred = 0
        while transferred < volume:
	    todo = volume-transferred
	    if todo > pipette.max_volume and todo <= pipette.max_volume*2:
	    	vol = todo/2
	    else:
                vol = min(todo, pipette.max_volume)
            pipette.aspirate(vol, water["A1"], rate=1)
            pipette.dispense(vol, plate[well], rate=1)
            transferred += vol
        pipette.blow_out(plate[well])
        pipette.touch_tip(plate[well])
    pipette.drop_tip()


def run(protocol: protocol_api.ProtocolContext):
    water = protocol.load_labware('integra_1_reservoir_150ml', 11)

    tiprack_p200 = protocol.load_labware('standard_96_tiprack_200ul', 10)
    p50 = protocol.load_instrument('p50_single', 'left', tip_racks=[tiprack_p200])
    p50.well_bottom_clearance.aspirate = 0
    p50.well_bottom_clearance.dispense = 0

    #tiprack_p10 = protocol.load_labware('standard_96_tiprack_10ul', 9)
    #p10 = protocol.load_instrument('p10_single', 'right', tip_racks=[tiprack_p10])
    #p10.well_bottom_clearance.aspirate = 0.5
    #p10.well_bottom_clearance.dispense = 0.5

    pos = 1
    for plate_name, well_vols in config["PLATES"].items():
        dest_plate = protocol.load_labware('axygen_96_wellplate_200ul', pos, label=plate_name)
        dispense_water_to(dest_plate, water, well_vols, p50)
	pos += 1
